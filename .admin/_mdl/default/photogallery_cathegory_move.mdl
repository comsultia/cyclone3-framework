sub BaseModul
{
 my $id=$form{id};

 if ($form{set}eq"yes")
 {
  if ($form{IDcathegory})
  {
   $dbh->Query("UPDATE photogallery SET IDcathegory='$form{IDcathegory}' WHERE IDcathegory='$id' LIMIT $form{pics}");
  }
  return "\n<script>\nparent.document.frames['frm_base'].location.reload();\n</script>";
 }
 else
 {
  $HTML_HEADER{BODY}{extract}="yes";
  my $mdl_temp;
  my $cathegories;
  my $db_micro = $dbh->Query("SELECT ID,tinyname,active FROM photogallery_cathegory WHERE ID LIKE '$id%' ORDER BY ID");
  my $lines=$db_micro->NumRows();
  if ($lines)
  {
   if (my @db_micro_line=$db_micro->FetchRow())
   {
    $mdl_temp=<<"HEADER";
<table width=100% cellspacing=0 cellpadding=0 border=0><tr><td drag_here>
<form name="$form{type}\_$id"  
action="core.pl?type=$form{type}&id=$id&set=yes" target="frm_micro" method="POST">
</td><td width=100% style="FONT:bold 10px Verdana;COLOR:#F0F0F0;">

HEADER

    my $db_micro1 = $dbh->Query("SELECT ID FROM photogallery WHERE IDcathegory='$id'");
    my $lines=$db_micro1->NumRows();
	if ($lines)
	{
	 $mdl_temp.=<<"HEADER";
	 &nbsp;You are about to move images from <input type=text name="tinyname" value="$db_micro_line[1] - $lines images" class=input0 maxlength=20 style="width:250px;"><BR>
HEADER



 my $db_micro2 = $dbh->Query("SELECT ID,fullname,tinyname FROM photogallery_cathegory WHERE ID<>'$id' ORDER BY ID");
 while (@db_micro2_line=$db_micro2->FetchRow())
 {
  my $from;
  for (my $i=1;$i<length($db_micro2_line[0]);$i++){$from.="&nbsp;&nbsp;";}
	$mdl_micro.=&select_add('value'=>$db_micro2_line[2],'html'=>$from.$db_micro2_line[2],'plus'=>"this.parentElement.parentElement.all['VALUE2'].value='$db_micro2_line[0]';");
 }
 $mdl_temp.="<DIV style=\"COLOR:black;\">".&select_create(
 	'name'		=>	"IDcathegory_",
	'plus'		=>	"<input id=VALUE2 value=\"\" name=IDcathegory type=hidden>",
	'value'		=>	"move to...",
	'maxlength'	=>	100,
	'width'		=>	250-12,
	'select'	=>	$mdl_micro
 )."</DIV>";


	$mdl_temp.=<<"HEADER";
&nbsp;move&nbsp;&nbsp;<input type=text name="pics" value="$lines" class=input0 maxlength=5 style="width:50px;"> images<BR>
<table height=16 width=100% cellspacing=0 cellpadding=0 border=0 background="$tom::H_media/grf/admin/win_top_0_back.gif"><tr><td width=50% align=right><img src="$tom::H_media/grf/admin/win_top_0_del.gif" border=0><BR></td><td><center><input type=submit drag_here value="Execute!" class=btn0 onclick="box_erase2();"></center></td><td align=left width=50%><img src="$tom::H_media/grf/admin/win_top_0_del.gif" border=0><BR></td></tr></table>	
</td><td></form></td></tr></table>
HEADER



	}
   }
  }
  
  my $box=&box_create2("Move pictures",
	'color_base0'	=>	"#0B63F1",
	'width'			=>	250,
	'height'		=>	50,	
	'close'			=>	"yes",
	'html'			=>	$mdl_temp);
  return $box;
 }
}













1;
