sub BaseModul{
require "_table.m";
require "_info.m";

my $page_limit=40;
my $page_from=$page_limit*$form{page};
$form{page}="0" unless $form{page};

my $info=&info_create(
#'icon'	=>	True,
'icon'	=>	"style=\"cursor:hand;\" onclick=\"load_box('core.pl?type=tabulky-search');\"",
'new'	=>	True,
'title'	=>	"Zoznam tabuliek",
'next'	=>	$form{page},
'prev'	=>	$form{page}
);



my $table=HP_TABLE->new(
'title'			=>	"Zoznam tabuliek",
'cellspacing'		=>	1,
'cellpadding'		=>	1,
'color_active'		=>	"#F0F0C0",
'link_core'		=>	"core.pl?type=$form{type}&",
'define'		=>
{
'0'	=>
	{
	'id'		=>	"",
	'code'		=>	"<%1%>",
	},
'2'	=>
	{
	'id'		=>	"time",
	'code'		=>	"<%1%>",
	'select'	=>	"orderby=starttime DESC",
	'class'		=>	"td_act",
	'td_plus'	=>	"nowrap"
	},
'4'	=>
	{
	'id'		=>	"kategoria tabulky",
	'code'		=>	"&nbsp;<%1%>&nbsp;",
	'td_plus'	=>	"style=\"FONT:11px Verdana;\" nowrap"
	},
'5'	=>
	{
	'id'		=>	"title",
	'code'		=>	"<%1%>",
	'td_plus'	=>	"nowrap"
	},
'99'	=>
	{
	'id'		=>	"X",
	'code'		=>	"<%1%><BR>",
	'td_plus'	=>	"align=middle"
	}
}
);

#my $orderby="ORDER BY starttime DESC";
#if ($form{'orderby'}){$orderby="ORDER BY $form{'orderby'}";}


my $orderby="ORDER BY starttime DESC";
if ($form{'orderby'}){$orderby="ORDER BY $form{'orderby'}";}
my $where;
if ($form{'whereby'}){$where="WHERE $form{whereby}='$form{where}'";}
if ($form{'wherelike'}){$where="WHERE $form{wherelike} LIKE '%$form{where}%'";}
my $db_micro = $dbh->Query("
	SELECT ID,IDcathegory,starttime,title,variables
	FROM sport_markiza_sk.tabulky $where $orderby
	LIMIT $page_from,$page_limit");
while (my @db_micro_line=$db_micro->FetchRow())
{
 # TIME
 my (undef,$minR,$hourR,$mdayR,$momR,$yearR,undef,undef,undef)=localtime($db_micro_line[2]);
 $momR++;$yearR=$yearR+1900-2000;
 if ($minR<"10"){$minR="0$minR"}
 if ($hourR<"10"){$hourR="0$hourR"}
 if ($mdayR<"10"){$mdayR="0$mdayR"}
 if ($momR<"10"){$momR="0$momR"}
 if ($yearR<"10"){$yearR="0$yearR"}
 my $time_start="$mdayR/$momR/$yearR"; #$hourR:$minR";
 
 my $cl_class="tr1";
 my $cl_color="#8FADF9";
# if (($db_micro_line[2]<$current_time)&&($db_micro_line[3]>$current_time)){$cl_color="#B0CFFF"}
# if ($db_micro_line[2]>$current_time){$cl_color="#E0EFFF"}

 my $db_micro1 = $dbh->Query("SELECT fullname FROM sport_markiza_sk.tabulky_cathegory WHERE ID='$db_micro_line[1]' LIMIT 1");
 if (my @db_micro1_line=$db_micro1->FetchRow())
 {
  $db_micro_line[1]=$db_micro1_line[0];
  $db_micro_line[1]=~s|/([^/]*?)$|<B>/\1</B>|i;
 }
 
#$db_micro_line[3]=~s|\n|<BR>|g;
#$db_micro_line[4]=~s|\n|<BR>|g;
	
$table->add(
'class'		=>	$cl_class,
'color'		=>	$cl_color,
'define'	=>{

'time'	=>
{'1'=>"$time_start",'2'=>"$time_start"},

''	=>
{'1'=>"<a href=\"core.pl?type=tabulky-edit&id=<!--ID-->\" target=\"frm_micro\"><img src=\"$tom::H_media/grf/admin/list.gif\" border=0 align=absmiddle></a>"},

'kategoria tabulky'	=>
{'1'=>$db_micro_line[1]},

'title'	=>
{'1'=>$db_micro_line[3]},

'X'	=>
{'1'=>"<a href=\"core.pl?type=tabulky-del&id=<!--ID-->\" target=\"frm_micro\"><img src=$tom::H_media/grf/admin/close1.gif border=0></a>"}

},'replace'=>{'ID'=>$db_micro_line[0]});

}


return $info.$table->HTML;}













1;
