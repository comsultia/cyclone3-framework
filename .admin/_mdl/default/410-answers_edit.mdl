sub BaseModul
{

 my $IDanswer=$form{ID} if ($form{ID});
 my $IDquestion=$form{idquestion} if ($form{idquestion});

  $HTML_HEADER{BODY}{extract}="yes";

  #return "SELECT * FROM TOM.Ca410 WHERE ID='$ID' LIMIT 1";

  my %db_micro_line;

  if ($form{ID} ne "")
  {
  	$db_micro = $dbh->Query("SELECT * FROM TOM.Ca410_answer WHERE ID='$IDanswer' LIMIT 1");
  	%db_micro_line=$db_micro->FetchHash();
  }

  if (defined $IDanswer)
  {
   (undef,$minR1,$hourR1,$mdayR1,$momR1,$yearR1,undef,undef,undef) = localtime($db_micro_line{starttime});
   (undef,$minR2,$hourR2,$mdayR2,$momR2,$yearR2,undef,undef,undef) = localtime($db_micro_line{endtime});
  }
  else
  {
   (undef,$minR1,$hourR1,$mdayR1,$momR1,$yearR1,undef,undef,undef) = localtime($current_time);
   (undef,$minR2,$hourR2,$mdayR2,$momR2,$yearR2,undef,undef,undef) = localtime(0);
  }

  $momR1++;$yearR1=$yearR1+1900;
  $momR2++;$yearR2=$yearR2+1900;

  my $db_microx = $dbh->Query("SELECT title FROM TOM.Ca410 WHERE ID='$IDquestion' LIMIT 1");
  my %db_microx_line=$db_microx->FetchHash();

  $db_micro1 = $dbh->Query("SELECT ID FROM markiza_sk.a120 WHERE nickname='$ENV{REMOTE_USER}' AND IDtype='1'");
  if (@db_micro1_line=$db_micro1->FetchRow()) { $db_micro_line{IDeditor}=$db_micro1_line[0]; }
  else
  {
   $db_micro1 = $dbh->Query("	INSERT INTO markiza_sk.a120(IDtype,nickname,fullname,active)
   				VALUES ('1','$ENV{REMOTE_USER}','$ENV{REMOTE_USER}','Y')");
   $db_micro1 = $dbh->Query("SELECT ID FROM markiza_sk.a120 WHERE nickname='$ENV{REMOTE_USER}' AND IDtype='1'");
   if (@db_micro1_line=$db_micro1->FetchRow()) { $db_micro_line{IDeditor}=$db_micro1_line[0]; }
  }

  my $mdl_temp=<<"HEADER";
  <table width=100% cellspacing=0 cellpadding=0 border=0><tr><td>
  <form name="answers_edit" action="core.pl?type=410-answers&frm=$form{frm}&id=$IDanswer&idquestion=$IDquestion&set=yes" method="POST" enctype="multipart/x-form-data" target="ank_frm_$form{frm}">
  </td><td width=100% style="FONT:10px Verdana;COLOR:white;">
  &nbsp;$db_microx_line{title}<BR>
  <input type=hidden name="IDeditor" value="$db_micro_line{IDeditor}" />
  <input type=text name="answer" id="description" value="$db_micro_line{answer}" class=input0 maxlength=150 style="FONT:9px Verdana;width:445px;" drag_resizeX='0'><BR>

HEADER

 my $temp;

  $mdl_temp.="<table width=100% cellspacing=0 cellpadding=0 border=0><tr><td style=\"FONT:10px Verdana;COLOR:white;\"  width=\"50%\">&nbsp;Zobrazit od:<br>";

  $mdl_temp.="<table cellspacing=2 cellpadding=0 border=0><tr><td colspan=16></td></tr><tr>";

  my $width0=30-12;
  my $width1=50-12;

  my $mdl_micro;
  for (my $i=1;$i<=31;$i++)
  {
   $mdl_micro.="<div onclick=\"this.parentElement.parentElement.all['VALUE'].value='$i';\">&nbsp;$i</div>\n";
  }
  $mdl_temp.="<td>".&select_create(
 	'name'		=>	"day1",
	'value'		=>	$mdayR1,
	'maxlength'	=>	30,
	'width'		=>	$width0,
	'width1'	=>	50,
	'select'	=>	$mdl_micro
  )."</td>";


  my $mdl_micro;
  @mesiac=("january","february","march","april","may","june","july","august","september","october","november","december");
  for (my $i=1;$i<=12;$i++)
  {
   $mdl_micro.="<div onclick=\"this.parentElement.parentElement.all['VALUE'].value='$i';\">&nbsp;$i-$mesiac[$i-1]</div>\n";
  }
  $mdl_temp.="<td>".&select_create(
 	'name'		=>	"mom1",
	'value'		=>	$momR1,
	'maxlength'	=>	30,
	'width'		=>	$width0,
	'width1'	=>	90,
	'select'	=>	$mdl_micro
  )."</td>";



  my $mdl_micro;
  for (my $i=2000;$i<=2050;$i++)
  {
   $mdl_micro.="<div onclick=\"this.parentElement.parentElement.all['VALUE'].value='$i';\">&nbsp;$i</div>\n";
  }
  $mdl_temp.="<td>".&select_create(
 	'name'		=>	"year1",
	'value'		=>	$yearR1,
	'maxlength'	=>	30,
	'width'		=>	$width1,
	'width1'	=>	50,
	'select'	=>	$mdl_micro
  )."</td>";


  $mdl_temp.="<td>&nbsp;</td>";


  my $mdl_micro;
  for (my $i=0;$i<=23;$i++)
  {
   $mdl_micro.="<div onclick=\"this.parentElement.parentElement.all['VALUE'].value='$i';\">&nbsp;$i</div>\n";
  }
  $mdl_temp.="<td>".&select_create(
 	'name'		=>	"hour1",
	'value'		=>	$hourR1,
	'maxlength'	=>	30,
	'width'		=>	$width0,
	'width1'	=>	50,
	'select'	=>	$mdl_micro
  )."</td>";

  $mdl_temp.="<td></td>";

  my $mdl_micro;
  for (my $i=0;$i<=55;$i=$i+5)
  {
   $mdl_micro.="<div onclick=\"this.parentElement.parentElement.all['VALUE'].value='$i';\">&nbsp;$i</div>\n";
  }
  $mdl_temp.="<td>".&select_create(
 	'name'		=>	"min1",
	'value'		=>	$minR1,
	'maxlength'	=>	30,
	'width'		=>	$width0,
	'width1'	=>	50,
	'select'	=>	$mdl_micro
  )."</td>";

  if ($form{ID}>0)
  {
   if (($db_micro_line{endtime} eq "0") || ($db_micro_line{endtime} eq "")) { $allow_endtime=""; $allow_endtime_show="none"; } else { $allow_endtime="checked"; $allow_endtime_show="normal"; }
  }
  else
  {
   $allow_endtime=""; $allow_endtime_show="none";
  }

  $mdl_temp.="</tr></table></td><td style=\"FONT:10px Verdana;COLOR:white;\">";
  $mdl_temp.=" Do:<br><input type=\"checkbox\" name=\"allow_endtime\" value=\"1\" onclick=\"if (this.checked) {document.getElementById('allow_endtime_div').style.display='block';} else {document.getElementById('allow_endtime_div').style.display='none'; }\" $allow_endtime>";
  $mdl_temp.="</td><td style=\"FONT:10px Verdana;COLOR:white;\" width=\"50%\" valign=\"bottom\">";

  #$mdl_temp.="<td nowrap>-</td>";

  $mdl_temp.="<div id=\"allow_endtime_div\" style=\"display: $allow_endtime_show\"><table cellspacing=2 cellpadding=0 border=0><tr><td colspan=16 valign=\"top\"></td></tr><tr>";

  my $mdl_micro;
  for (my $i=1;$i<=31;$i++)
  {
   $mdl_micro.="<div onclick=\"this.parentElement.parentElement.all['VALUE'].value='$i';\">&nbsp;$i</div>\n";
  }
  $mdl_temp.="<td>".&select_create(
 	'name'		=>	"day2",
	'value'		=>	$mdayR2,
	'maxlength'	=>	30,
	'width'		=>	$width0,
	'width1'	=>	50,
	'select'	=>	$mdl_micro
  )."</td>";


  my $mdl_micro;
  @mesiac=("january","february","march","april","may","june","july","august","september","october","november","december");
  for (my $i=1;$i<=12;$i++)
  {
   $mdl_micro.="<div onclick=\"this.parentElement.parentElement.all['VALUE'].value='$i';\">&nbsp;$i-$mesiac[$i-1]</div>\n";
  }
  $mdl_temp.="<td>".&select_create(
 	'name'		=>	"mom2",
	'value'		=>	$momR2,
	'maxlength'	=>	30,
	'width'		=>	$width0,
	'width1'	=>	90,
	'select'	=>	$mdl_micro
  )."</td>";

  my $mdl_micro;
  for (my $i=2000;$i<=2050;$i++)
  {
   $mdl_micro.="<div onclick=\"this.parentElement.parentElement.all['VALUE'].value='$i';\">&nbsp;$i</div>\n";
  }
  $mdl_temp.="<td>".&select_create(
 	'name'		=>	"year2",
	'value'		=>	$yearR2,
	'maxlength'	=>	30,
	'width'		=>	$width1,
	'width1'	=>	50,
	'select'	=>	$mdl_micro
  )."</td>";


  $mdl_temp.="<td>&nbsp;</td>";


  my $mdl_micro;
  for (my $i=0;$i<=23;$i++)
  {
   $mdl_micro.="<div onclick=\"this.parentElement.parentElement.all['VALUE'].value='$i';\">&nbsp;$i</div>\n";
  }
  $mdl_temp.="<td>".&select_create(
 	'name'		=>	"hour2",
	'value'		=>	$hourR2,
	'maxlength'	=>	30,
	'width'		=>	$width0,
	'width1'	=>	50,
	'select'	=>	$mdl_micro
 )."</td>";

  $mdl_temp.="<td></td>";

  my $mdl_micro;
  for (my $i=0;$i<=55;$i=$i+5)
  {
   $mdl_micro.="<div onclick=\"this.parentElement.parentElement.all['VALUE'].value='$i';\">&nbsp;$i</div>\n";
  }
  $mdl_temp.="<td>".&select_create(
 	'name'		=>	"min2",
	'value'		=>	$minR2,
	'maxlength'	=>	30,
	'width'		=>	$width0,
	'width1'	=>	50,
	'select'	=>	$mdl_micro
  )."</td>";

  $mdl_temp.="</tr></table></td></table>";



  $mdl_temp.=<<"HEADER";
  <table height=16 width=100% cellspacing=0 cellpadding=0 border=0 background="$tom::H_media/grf/admin/win_top_0_back.gif"><tr><td width=50% align=right><img src="$tom::H_media/grf/admin/win_top_0_del.gif" border=0><BR></td><td><center><input type=submit drag_here value="Uložiť!" class=btn0 onclick="box_erase2();"></center></td><td align=left width=50%><img src="$tom::H_media/grf/admin/win_top_0_del.gif" border=0><BR></td></tr></table><br>
HEADER


  $mdl_temp.="</td><td></form></td></tr></table>";

my $box;

  $box=&box_create2("Editacia odpovede na anketu",
	'color_base0'	=>	"#0B63F1",
	'width'			=>	200,
	'height'		=>	50,
	'close'			=>	"yes",
	'html'			=>	$mdl_temp);

  return $box;


  return undef;

}


1;
