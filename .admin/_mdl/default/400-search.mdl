sub BaseModul
{
	if ($form{set})
	{

	}
	else
	{
		$HTML_HEADER{BODY}{extract}="yes";
		#$HTML_HEADER{BODY}{onunload}="parent.box_loading.style.display='block';";

		#(undef,$minR1,$hourR1,$mdayR1,$momR1,$yearR1,undef,undef,undef) = localtime($current_time+(3600));
		(undef,$minR1,$hourR1,$mdayR1,$momR1,$yearR1,undef,undef,undef) = localtime(791593200);
		(undef,$minR2,$hourR2,$mdayR2,$momR2,$yearR2,undef,undef,undef) = localtime($current_time+(3600));

		$momR1++;$yearR1=$yearR1+1900;
		$momR2++;$yearR2=$yearR2+1900;

		my $mdl_temp=<<"HEADER";
		<table width=100% cellspacing=0 cellpadding=0 border=0><tr><td>
		<form name="$form{type}\_$id"
		action="core.pl" target="frm_base" METHOD="POST">
		</td><td width=100% style="FONT:10px Verdana;COLOR:white;">
HEADER

		#&nbsp;Definition:<BR>
		#my $mdl_micro_test.="<div onclick=\"this.parentElement.parentElement.all['VALUE'].value='$db_micro_line[3]';\">&nbsp;$db_micro_line[3]</div>\n";
		#my   $mdl_micro_test.=&select_add('value'=>"task",'html'=>"task");
		#   $mdl_micro_test.=&select_add('value'=>"report",'html'=>"report");
		#   $mdl_micro_test.=&select_add('value'=>"query",'html'=>"query");
		#   $mdl_micro_test.=&select_add('value'=>"meeting",'html'=>"meeting");
		#   $mdl_micro_test.=&select_add('value'=>"phonecall",'html'=>"phonecall");
		#   $mdl_micro_test.=&select_add('value'=>"email",'html'=>"email");
		#
		# $mdl_temp.=&select_create(
		#	'name'		=>	"title",
		#	'value'		=>	$db_micro_line[3],
		#	'maxlength'	=>	30,
		#	'width'		=>	250,
		#	'height'	=>	150,
		#	'drag_resizeX'	=>	'-150',
		#	'select'	=>	$mdl_micro_test
		# );

		######################################################
		# title and subtitle                                                                    #
		######################################################

		$mdl_temp.=<<"HEADER";
	<input type=hidden name="search" value="1">
	&nbsp;Titul obsahuje:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hľadať v <input type=hidden name="type" value="400"><input type="radio" name="archive" value="0" checked>článkoch&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="radio" name="archive" value="1">archíve<br>
	<input type=text name="title" value="" class=input0 maxlength=160 style="FONT:9px Verdana;width:445px;" drag_resizeX='0'><BR>
	&nbsp;Podtitul obsahuje:<BR>
	<input type=text name="subtitle" value="" class=input0 maxlength=160 style="FONT:9px Verdana;width:445px;" drag_resizeX='0'><BR>
	&nbsp;Autor:<BR>
HEADER

		######################################################
		# author                                                                                 #
		######################################################

		my $mdl_micro;
		$db_micro1 = $dbh->Query("SELECT ID,nickname FROM $MAIN_db_a120 ORDER BY nickname");
		while (@db_micro1_line=$db_micro1->FetchRow())
		{
			#$mdl_micro.="<div onclick=\"this.parentElement.parentElement.all['VALUE'].value='$db_micro1_line[0]';\">&nbsp;$db_micro1_line[0]</div>\n";
			$mdl_micro.=&select_add('value'=>$db_micro1_line[0],'html'=>$db_micro1_line[1]);
		}

		$mdl_temp.=&select_create(
			'name'		=>	"IDauthor",
			'value'		=>	$db_micro_line{IDauthor},
			'maxlength'	=>	30,
			'width'		=>	250,
			'height'	=>	200,
			'drag_resizeX'	=>	'-150',
			'select'	=>	$mdl_micro
		);

		######################################################
		# editor                                                                                  #
		######################################################

		$mdl_temp.="&nbsp;Editor:<BR>";

		$db_micro1 = $dbh->Query("SELECT ID,nickname FROM $MAIN_db_a120 ORDER BY nickname");
		while (@db_micro1_line=$db_micro1->FetchRow())
		{
			#$mdl_micro.="<div onclick=\"this.parentElement.parentElement.all['VALUE'].value='$db_micro1_line[0]';\">&nbsp;$db_micro1_line[0]</div>\n";
			$mdl_micro.=&select_add('value'=>$db_micro1_line[0],'html'=>$db_micro1_line[1]);
		}

		$mdl_temp.=&select_create(
			'name'		=>	"IDeditor",
			'value'		=>	$db_micro_line{IDeditor},
			'maxlength'	=>	30,
			'width'		=>	250,
			'height'	=>	200,
			'drag_resizeX'	=>	'-150',
			'select'	=>	$mdl_micro
		);

		######################################################
		# category                                                                                 #
		######################################################

		$mdl_temp.="Kategória:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type=\"checkbox\" name=\"cat_allow_subs\" value=\'1\'> aj podkategórie<br>";

		if ($creten)
		{
			my $mdl_micro;
			my $selected;
			my $selected2;
			$db_micro1 = $dbh->Query("SELECT ID,name FROM $MAIN_db_a400_category ORDER BY ID");
			while (@db_micro1_line=$db_micro1->FetchRow())
			{
				my $from;
				for (my $i=1;$i<length($db_micro1_line[0]);$i++){$from.="&nbsp;&nbsp;";}
				if ($db_micro_line{IDcategory} eq $db_micro1_line[0]){$selected=$db_micro1_line[1];$selected2=$db_micro1_line[0];}
				#$mdl_micro.="<div onclick=\"this.parentElement.parentElement.all['VALUE2'].value='$db_micro1_line[0]';this.parentElement.parentElement.all['VALUE'].value='$db_micro1_line[1]';\">&nbsp;$from$db_micro1_line[2]</div>\n";

				$mdl_micro.=&select_add('value'=>$db_micro1_line[0],'html'=>$from.$db_micro1_line[2],'plus'=>"this.parentElement.parentElement.all['VALUE2'].value='$db_micro1_line[0]';");
			}
			# $mdl_temp.=&select_create(
			# 	'name'		=>	"IDcathegory_",
			#	'plus'		=>	"<input id=VALUE2 value=\"$selected2\" name=IDcathegory2 type=hidden>",
			#	'value'		=>	$selected,
			#	'maxlength'	=>	30,
			#	'width'		=>	445-13,
			#	'select'	=>	$mdl_micro
			# );
		}

		my $tree_temp;
		my $tree_temp_line=<<"HEADER";
	<table width=100% cellspacing=0 cellpadding=0>
			<tr>
			<%OD%>
			<td><img src=t.gif width=3 height=1 border=0><BR></td>
			<td nowrap style="FONT:bold 11px Verdana;"></td>
		<td width=100% style="FONT:9px Verdana;"
			onmouseover="this.style.background='blue';this.style.color='white';"
			onmouseout="this.style.background='';this.style.color='';"
			<%PLUS%>
		><%NAME%></td>
		</tr>
	</table>
HEADER

		my $tree_temp_od="<td <%TBG%> align=middle <%VALIGN%>><%IMG%><img src=t.gif width=11 height=1 border=0><BR></td>";
		my $selected;
		my $selected2;
		my $db_micro1 = $dbh->Query("
			SELECT ID,name,xdata
			FROM $MAIN_db_a400_category
			ORDER BY ID");
		while (my @db_micro1_line=$db_micro1->FetchRow())
		{
			if ($db_micro_line{IDcategory} eq $db_micro1_line[0]){$selected=$db_micro1_line[1];$selected2=$db_micro1_line[0];}
			my $tr_uroven=my @tr_cesta=split('',$db_micro1_line[0]);
			$tree_temp.=$tree_temp_line;
			$width=$tr_uroven*10+5;
			$tree_temp =~s|<%NAME%>|$db_micro1_line[1]|g;
			$tree_temp =~s|<%ID%>|$db_micro1_line[0]|g;

			my $i0=-1;
			my $od;
			while ($i0<($tr_uroven))
			{
				$i0++;
				$od .= $tree_temp_od;
				$od =~s|<%TBG%>|<%TBG-$i0%>|g;
				if (($i0+1) == $tr_uroven)
				{
					$od=~s|<%IMG%>|<img src=t.gif width=1 height=3 border=0><BR><img src="$tom::H_media/grf/admin/forum_0_3.gif" border=0><BR>|g;
					$tree_temp =~s|<%TBG-$i0%>|background="$tom::H_media/grf/admin/forum_0_0.gif"|g;
				}
				if ($i0 == $tr_uroven)
				{
					$od=~s|<%VALIGN%>|valign=middle|g;
					$od=~s|<%IMG%>|<img src="$tom::H_media/grf/admin/tree_0.gif" border=0><BR>|g;
					$od =~s|<%TBG-$i0%>||g;
					$tree_temp =~s|<%TBG-$i0%>||g;
				}
				else
				{
					$od=~s|<%IMG%>||g;
				}
				$od=~s|<%VALIGN%>|valign=top|g;
			}
			$tree_temp =~s|<%OD%>|$od|g;
			$tree_temp =~s|<%BG%>|#96B2C8|g;
			$tree_temp =~s|<%PLUS%>|onclick="parentElement.parentElement.parentElement.parentElement.parentElement.all['VALUE'].value='$db_micro1_line[0]';parentElement.parentElement.parentElement.parentElement.parentElement.all['VALUE2'].value='$db_micro1_line[0]';"|g;
		}

		$mdl_temp.=&select_create(
			'name'		=>	"IDcategory",
			'value'		=>	$selected,
			'maxlength'	=>	30,
			'width'		=>	445-13,
			'height'	=>	200,
			'drag_resizeX'	=>	'0',
			'select'	=>	$tree_temp
		);

		# $mdl_temp.="a<BR>".$tree_temp."a<BR>";
		######################################################
		# starttime                                                                              #
		######################################################

		$mdl_temp.="Zverejnený od/do:<br><table width=100% cellspacing=2 cellpadding=0 border=0><tr><td colspan=16></td></tr><tr><td width=50%>&nbsp;</td>";

		my $width0=30-12;
		my $width1=50-12;

		my $mdl_micro;
		for (my $i=1;$i<=31;$i++)
		{
			$mdl_micro.="<div onclick=\"this.parentElement.parentElement.all['VALUE'].value='$i';\">&nbsp;$i</div>\n";
		}
		$mdl_temp.="<td>".&select_create(
			'name'		=>	"day1",
			'value'		=>	$mdayR1,
			'maxlength'	=>	30,
			'width'		=>	$width0,
			'width1'	=>	50,
			'select'	=>	$mdl_micro
		)."</td>";

		my $mdl_micro;
		@mesiac=("january","february","march","april","may","june","july","august","september","october","november","december");
		for (my $i=1;$i<=12;$i++)
		{
			$mdl_micro.="<div onclick=\"this.parentElement.parentElement.all['VALUE'].value='$i';\">&nbsp;$i-$mesiac[$i-1]</div>\n";
		}
		$mdl_temp.="<td>".&select_create(
			'name'		=>	"mom1",
			'value'		=>	$momR1,
			'maxlength'	=>	30,
			'width'		=>	$width0,
			'width1'	=>	90,
			'select'	=>	$mdl_micro
		)."</td>";

		my $mdl_micro;
		for (my $i=1995;$i<=2050;$i++)
		{
			$mdl_micro.="<div onclick=\"this.parentElement.parentElement.all['VALUE'].value='$i';\">&nbsp;$i</div>\n";
		}
		$mdl_temp.="<td>".&select_create(
			'name'		=>	"year1",
			'value'		=>	$yearR1,
			'maxlength'	=>	30,
			'width'		=>	$width1,
			'width1'	=>	50,
			'select'	=>	$mdl_micro
		)."</td>";

		$mdl_temp.="<td>&nbsp;</td>";

		my $mdl_micro;
		for (my $i=0;$i<=23;$i++)
		{
			$mdl_micro.="<div onclick=\"this.parentElement.parentElement.all['VALUE'].value='$i';\">&nbsp;$i</div>\n";
		}
		$mdl_temp.="<td>".&select_create(
			'name'		=>	"hour1",
			'value'		=>	$hourR1,
			'maxlength'	=>	30,
			'width'		=>	$width0,
			'width1'	=>	50,
			'select'	=>	$mdl_micro
		)."</td>";

			$mdl_temp.="<td></td>";

		my $mdl_micro;
		for (my $i=0;$i<=55;$i=$i+5)
		{
			$mdl_micro.="<div onclick=\"this.parentElement.parentElement.all['VALUE'].value='$i';\">&nbsp;$i</div>\n";
		}
		$mdl_temp.="<td>".&select_create(
			'name'		=>	"min1",
			'value'		=>	$minR1,
			'maxlength'	=>	30,
			'width'		=>	$width0,
			'width1'	=>	50,
			'select'	=>	$mdl_micro
		)."</td>";

		$mdl_temp.="<td nowrap>-</td>";

		######################################################
		# endtime                                                                                #
		######################################################

		my $mdl_micro;
		for (my $i=1;$i<=31;$i++)
		{
			$mdl_micro.="<div onclick=\"this.parentElement.parentElement.all['VALUE'].value='$i';\">&nbsp;$i</div>\n";
		}
		$mdl_temp.="<td>".&select_create(
			'name'		=>	"day2",
			'value'		=>	$mdayR2,
			'maxlength'	=>	30,
			'width'		=>	$width0,
			'width1'	=>	50,
			'select'	=>	$mdl_micro
		)."</td>";

		my $mdl_micro;
		@mesiac=("january","february","march","april","may","june","july","august","september","october","november","december");
		for (my $i=1;$i<=12;$i++)
		{
			$mdl_micro.="<div onclick=\"this.parentElement.parentElement.all['VALUE'].value='$i';\">&nbsp;$i-$mesiac[$i-1]</div>\n";
		}
		$mdl_temp.="<td>".&select_create(
			'name'		=>	"mom2",
			'value'		=>	$momR2,
			'maxlength'	=>	30,
			'width'		=>	$width0,
			'width1'	=>	90,
			'select'	=>	$mdl_micro
		)."</td>";

		my $mdl_micro;
		for (my $i=1995;$i<=2050;$i++)
		{
			$mdl_micro.="<div onclick=\"this.parentElement.parentElement.all['VALUE'].value='$i';\">&nbsp;$i</div>\n";
		}
		$mdl_temp.="<td>".&select_create(
			'name'		=>	"year2",
			'value'		=>	$yearR2,
			'maxlength'	=>	30,
			'width'		=>	$width1,
			'width1'	=>	50,
			'select'	=>	$mdl_micro
		)."</td>";

		$mdl_temp.="<td>&nbsp;</td>";

		my $mdl_micro;
		for (my $i=0;$i<=23;$i++)
		{
			$mdl_micro.="<div onclick=\"this.parentElement.parentElement.all['VALUE'].value='$i';\">&nbsp;$i</div>\n";
		}
		$mdl_temp.="<td>".&select_create(
			'name'		=>	"hour2",
			'value'		=>	$hourR2,
			'maxlength'	=>	30,
			'width'		=>	$width0,
			'width1'	=>	50,
			'select'	=>	$mdl_micro
		)."</td>";

		$mdl_temp.="<td></td>";

		my $mdl_micro;
		for (my $i=0;$i<=55;$i=$i+5)
		{
			$mdl_micro.="<div onclick=\"this.parentElement.parentElement.all['VALUE'].value='$i';\">&nbsp;$i</div>\n";
		}
		$mdl_temp.="<td>".&select_create(
			'name'		=>	"min2",
			'value'		=>	$minR2,
			'maxlength'	=>	30,
			'width'		=>	$width0,
			'width1'	=>	50,
			'select'	=>	$mdl_micro
		)."</td>";

		$mdl_temp.="<td width=50%></td></tr></table>";

		######################################################
		# full                                                                                      #
		######################################################

		$mdl_temp.=<<"HEADER";
	&nbsp;Text obsahuje:<BR>
	<input type=text name="full" value="" class=input0 maxlength=160 style="FONT:9px Verdana;width:445px;" drag_resizeX='0'><BR>
HEADER

		# $mdl_temp.=<<"HEADER";
	#<table height=16 width=100% cellspacing=0 cellpadding=0 border=0 background="$tom::H_media/grf/admin/win_top_0_back.gif"><tr><td width=50% align=right><img src="$tom::H_media/grf/admin/win_top_0_del.gif" border=0><BR></td><td><center><input type=submit drag_here value="Vyhľadať!" class=btn0 onclick="box_erase2();"></center></td><td align=left width=50%><img src="$tom::H_media/grf/admin/win_top_0_del.gif" border=0><BR></td></tr></table>
	#HEADER
		#nezatvarajuci sa search


		$mdl_temp.=<<"HEADER";
	<table height=16 width=100% cellspacing=0 cellpadding=0 border=0 background="$tom::H_media/grf/admin/win_top_0_back.gif"><tr><td width=50% align=right><img src="$tom::H_media/grf/admin/win_top_0_del.gif" border=0><BR></td><td><center><input type=submit drag_here value="Vyhľadať!" class=btn0></center></td><td align=left width=50%><img src="$tom::H_media/grf/admin/win_top_0_del.gif" border=0><BR></td></tr></table>
HEADER

		$mdl_temp.="</td><td></form></td></tr></table>";

		my $box=&box_create2("Vyhľadanie článku",
			'color_base0'	=>	"#0B63F1",
			'width'			=>	200,
			'height'		=>	50,
			'close'			=>	"yes",
			'html'			=>	$mdl_temp);

		return $box;

		return undef;
	}
}
1;