#!/usr/bin/perl

sub BaseModul
{
require "_info.m";
#require "_table.m";

my $mdl_temp=<<"HEADER";
<style>
table.cat_listing td {
	font: 11px Verdana;
}
table.cat_listing td a {
	font: 13px Verdana;
}
</style>
&nbsp;&nbsp;<img src="$tom::H_media/grf/admin/tree_0.gif" border=0>&nbsp;<a style="FONT:bold 11px Verdana;" href="core.pl?type=500-category_add" target="frm_micro"><font color=white>nová</font></a>
<table cellSpacing=1 cellPadding=0 width="100%" border=0 class="cat_listing">
<%BASE%>
</table>
HEADER

my $mdl_temp_line=<<"HEADER";
 <tr onmouseover="this.style.background='#94B7FC';" onmouseout="this.style.background='';" style="BACKGROUND: #6487dc; cursor: default" >
  <td width="100%" nowrap>
   &nbsp;&nbsp;<%OD%>
   &nbsp;<a class=tree href="core.pl?type=500&whereby=IDcategory&where=<%ID%>" target=frm_base><b><%NAME%></b></a> [<%ID%>] <i>(<%ABOUT%>)</i>
  </td>
  <td style="font: bold 10px Verdana; background-color: #7497ec;" nowrap>
   &nbsp;<img onclick="this.src='core.pl?type=set_active&table=a500_category&id=<%ID%>';" src="$tom::H_grf/list_<%ACTIVE%>.gif" style="cursor: hand;"width=11 height=12 border=0>
   &nbsp; <a href="core.pl?type=500-category_edit&id=<%ID%>" target=frm_micro><IMG src="$tom::H_grf/list.gif" border=0></a>
   &nbsp; <a href="core.pl?type=500-category_add&id=<%ID%>"  target=frm_micro><IMG src="$tom::H_grf/close4.gif" border=0></a>
   <!-- &nbsp;&nbsp;<%DATE%>&nbsp; /-->&nbsp;<B>______0</B> článkov&nbsp;
   &nbsp;<a href="core.pl?type=500-category_move&id=<%ID%>" target=frm_micro><IMG src="$tom::H_grf/close3.gif" border=0></a>
   &nbsp;<a href="core.pl?type=500-category_del&id=<%ID%>" target=frm_micro><IMG src="$tom::H_grf/close2.gif" border=0></a>
   &nbsp;
  </td>
 </tr>
HEADER

=head1
my $mdl_temp_line=<<"HEADER";
 <table width=100% cellspacing=0 cellpadding=0>
    <tr>
     <td>
	 <%OD%>
	</td>
     <td nowrap style="FONT:bold 11px Verdana;"></td>
	 <td>
	 <td width=100%>
<table width=100% cellspacing=1 cellpadding=0 border=0
	style="BACKGROUND:#6487DC;"
	onmouseover="this.style.background='#94B7FC';"
	onmouseout="this.style.background='';"
>
<tr>
 <td width=100% bgcolor="#6487DC" style="FONT:11px Verdana;" nowrap>&nbsp;<a class="tree" href="core.pl?type=500&whereby=IDcategory&where=<%ID%>" target="frm_base"><B><%NAME%></B></a> [<%ID%>] <i>(<%ABOUT%>)</i></td>

 <td bgcolor="#7497EC" style="FONT:bold 10px Verdana;cursor:hand;" nowrap>&nbsp;<img src="$tom::H_media/grf/admin/list_<%ACTIVE%>.gif" width=11 height=12 border=0 onclick="this.src='core.pl?type=set_active&table=a500_category&id=<%ID%>';">&nbsp;&nbsp;<a href="core.pl?type=500-category_edit&id=<%ID%>" target="frm_micro"><font color=white><img src="$tom::H_media/grf/admin/list.gif" border=0></font></a>&nbsp;&nbsp;<a href="core.pl?type=500-category_add&id=<%ID%>" target="frm_micro"><font color=white><img src="$tom::H_media/grf/admin/close4.gif" border=0></font></a>&nbsp;&nbsp;<%DATE%>&nbsp;&nbsp;<B><%PICS%></B> obrázkov&nbsp;&nbsp;<a href="core.pl?type=500-category_move&id=<%ID%>" target="frm_micro"><font color=white><img src="$tom::H_media/grf/admin/close3.gif" border=0></font></a>&nbsp;&nbsp;<a href="core.pl?type=500-category_del&id=<%ID%>" target="frm_micro"><font color=white><img src="$tom::H_media/grf/admin/close2.gif" border=0></font></a>&nbsp;</td>
</tr>
</table>
	 </td>
    </tr>
 </table>
HEADER
=cut


my $mdl_temp_od="<td <%TBG%> align=middle <%VALIGN%>><%IMG%><img src=t.gif width=11 height=1 border=0><BR></td>";

my $info=&info_create(
'icon'	=>	True,
'title'	=>	"Zoznam kategórií obrázkov",
);


if (my $db_micro = $dbh->Query("SELECT ID,name,active FROM $MAIN_db_a500_category ORDER BY ID ASC"))
{
 while (my @db_micro_line=$db_micro->FetchRow())
 {
  #my $db_micro1 = $dbh->Query("SELECT COUNT(ID) FROM markiza_sk.a500 WHERE IDcategory='$db_micro_line[0]'");

  #my $lines=$db_micro1->FetchRow();

  my $tr_uroven=@tr_cesta=split('',$db_micro_line[0]);
  $mdl_temp=~s|<%BASE%>|$mdl_temp_line<%BASE%>|g;

   my (undef,$minR,$hourR,$mdayR,$momR,$yearR,undef,undef,undef)=localtime($db_micro_line[3]);
 $momR++;$yearR=$yearR+1900-2000;
  if ($minR<"10"){$minR="0$minR"}
  if ($hourR<"10"){$hourR="0$hourR"}
  if ($mdayR<"10"){$mdayR="0$mdayR"}
  if ($momR<"10"){$momR="0$momR"}
  if ($yearR<"10"){$yearR="0$yearR"}

  $width=$tr_uroven*10+5;
  $mdl_temp =~s|<%DATE%>|$mdayR.$momR.$yearR $hourR:$minR|g;
  #if ($db_micro_line[7] eq "Y"){$mdl_temp =~s|<%NAME%>|<font color="#00E050">$db_micro_line[2]</font>|g;}
  #if ($db_micro_line[7] eq "Y"){$mdl_temp =~s|<%NAME%>|<font color="#00E050">$db_micro_line[2]</font>|g;}
  $mdl_temp =~s|<%NAME%>|$db_micro_line[1]|g;
  #if (length($db_micro_line[5])>30)
  #{$db_micro_line[5]=substr($db_micro_line[5],0,30)."...";}
  #$mdl_temp =~s|<%ABOUT%>|$db_micro_line[5]|g;
  $nullid=$lines;
  $nullid=sprintf ('%07d', $nullid);
  $mdl_temp =~s|<%PICS%>|$nullid|g;

#  $mdl_temp =~s|<%ABOUT%>|$db_micro_line[5]|g;
  $id0=pack "A8",$db_micro_line[0];
  $id0=~s| |_|g;
  $mdl_temp =~s|<%ID0%>|$id0|g;
  if ($db_micro_line[2] eq "Y"){$mdl_temp=~s|<%ACTIVE%>|g|;}
  else {$mdl_temp=~s|<%ACTIVE%>|r|;}

  $i0=0;$od="";

=head1
  while ($i0<($tr_uroven))
  {
    $i0++;
   $od .= $mdl_temp_od;
   $od =~s|<%TBG%>|<%TBG-$i0%>|g;

   if (($i0+1) == $tr_uroven)
   {
    $od=~s|<%IMG%>|<img src=t.gif width=1 height=3 border=0><BR><img src="$tom::H_media/grf/admin/forum_0_3.gif" border=0><BR>|g;
    $mdl_temp =~s|<%TBG-$i0%>|background="$tom::H_media/grf/admin/forum_0_0.gif"|g;
   }

   if ($i0 == $tr_uroven)
   {
    $od=~s|<%VALIGN%>|valign=middle|g;
    $od=~s|<%IMG%>|<a href="core.pl?type=500&wherelike=IDcategory&where=$db_micro_line[0]" target="frm_base"><img src="$tom::H_media/grf/admin/tree_0.gif" border=0></a><BR>|g;
    $od =~s|<%TBG-$i0%>||g;
    $mdl_temp =~s|<%TBG-$i0%>||g;
   }
   else
   {
    $od=~s|<%IMG%>||g;
   }
   $od=~s|<%VALIGN%>|valign=top|g;
  }
=cut

  my $mdl_temp_od="<%IMG%>";

  while ($i0<(length($db_micro_line[0])/2))
  {
   $i0++;
   $od .= $mdl_temp_od;
   $od =~s|<%TBG%>|<%TBG-$i0%>|g;

   if (($i0+1) == (length($db_micro_line[0])/2))
   {
    $od=~s|<%IMG%>|<img src="$tom::H_media/grf/admin/forum_0_3.gif" border=0>|g;
   }

   if ($i0 == (length($db_micro_line[0])/2))
   {
    $od=~s|<%IMG%>|<a href="core.pl?type=400&wherelike=IDcategory&where=$db_micro_line[0]" target="frm_base"><img src="$tom::H_media/grf/admin/tree_0.gif" border=0></a>|g;
   }
   else
   {
    $od=~s|<%IMG%>|&nbsp;&nbsp;&nbsp;|g;
   }
  }


  $mdl_temp =~s|<%ID%>|$db_micro_line[0]|g;

  $mdl_temp =~s|<%OD%>|$od|g;

  $mdl_temp =~s|<%BG%>|#96B2C8|g;

  $i=$i+2;

 }
}
return $info.$mdl_temp;}













1;
