sub BaseModul
{

 my $id=$form{ID} if ($form{ID});
 if ($form{set})
 {

 }
 else #tu je ten predel!!!------------------------------------------------------------------------------------------------------
 {
  $HTML_HEADER{BODY}{extract}="yes";

  #$HTML_HEADER{BODY}{onunload}="parent.box_loading.style.display='block';";
  $db_micro = $dbh->Query("SELECT * FROM markiza_sk.a020_archiv WHERE ID='$id' LIMIT 1");
  %db_micro_line=$db_micro->FetchHash();

  (undef,$minR1,$hourR1,$mdayR1,$momR1,$yearR1,undef,undef,undef) = localtime(time);
  (undef,$minR2,$hourR2,$mdayR2,$momR2,$yearR2,undef,undef,undef) = localtime(time+86400);

  $momR1++;$yearR1=$yearR1+1900;
  $momR2++;$yearR2=$yearR2+1900;

  #action="core.pl?type=$form{type}&id=$id&set=yes&image=$db_micro_line{xrelated}" method="POST">

  my $temp_string;
  if ($form{onlyarchive} eq "1") { $temp_string="archiv"; } else { $temp_string="grabbersetup"; }

########for testing purposes .. targeting into the same frame
  my $mdl_temp=<<"HEADER";
  <table width=100% cellspacing=0 cellpadding=0 border=0><tr><td>
  <form action="core.pl?type=020-$temp_string&search=1" method="POST" enctype="multipart/x-form-data" target="frm_base">
  </td><td width=100% style="FONT:10px Verdana;COLOR:white;">
HEADER

 my $temp;

  while ($db_micro_line{ind}=~s|<INDEX id="(.*?)" value="(.*?)" description="(.*?)" />|<INDEXTO>|i)
  {
   $temp.="<id=$1 value=$2 desc=$3>\n";
  }
  $indexes=$temp;

=head1
  <table height=16 width=100% cellspacing=0 cellpadding=0 border=0 background="$tom::H_media/grf/admin/win_top_0_back.gif"><tr><td width=50% align=right><img src="$tom::H_media/grf/admin/win_top_0_del.gif" border=0><BR></td><td><center><input type=button drag_here value="vložiť 'kostru'" class=btn0 onclick="document.forms['indexesEdit_$id'].indexes.text=document.forms['indexesEdit_$id'].indexes.text + '<id= value= desc=>' ;"></center></td><td align=left width=50%><img src="$tom::H_media/grf/admin/win_top_0_del.gif" border=0><BR></td></tr></table><br>
=cut

  if ($form{onlyarchive} eq "1")
  {
   undef $minR1;
   undef $hourR1;
   undef $mdayR1;
   undef $momR1;
   undef $yearR1;
   undef $minR2;
   undef $hourR2;
   undef $mdayR2;
   undef $momR2;
   undef $yearR2;
  }

  $mdl_temp.="<table width=100% cellspacing=0 cellpadding=0 border=0><tr><td style=\"FONT:10px Verdana;COLOR:white;\"  width=\"50%\">&nbsp;Nahrávaná od/do:<br>";

  $mdl_temp.="<table cellspacing=2 cellpadding=0 border=0><tr><td colspan=16></td></tr><tr>";

  my $width0=30-12;
  my $width1=50-12;

  my $mdl_micro;
  for (my $i=1;$i<=31;$i++)
  {
   $mdl_micro.="<div onclick=\"this.parentElement.parentElement.all['VALUE'].value='$i';\">&nbsp;$i</div>\n";
  }
  $mdl_temp.="<td>".&select_create(
 	'name'		=>	"day1",
	'value'		=>	$mdayR1,
	'maxlength'	=>	30,
	'width'		=>	$width0,
	'width1'	=>	50,
	'select'	=>	$mdl_micro
  )."</td>";


  my $mdl_micro;
  @mesiac=("january","february","march","april","may","june","july","august","september","october","november","december");
  for (my $i=1;$i<=12;$i++)
  {
   $mdl_micro.="<div onclick=\"this.parentElement.parentElement.all['VALUE'].value='$i';\">&nbsp;$i-$mesiac[$i-1]</div>\n";
  }
  $mdl_temp.="<td>".&select_create(
 	'name'		=>	"mom1",
	'value'		=>	$momR1,
	'maxlength'	=>	30,
	'width'		=>	$width0,
	'width1'	=>	90,
	'select'	=>	$mdl_micro
  )."</td>";



  my $mdl_micro;
  for (my $i=2000;$i<=2050;$i++)
  {
   $mdl_micro.="<div onclick=\"this.parentElement.parentElement.all['VALUE'].value='$i';\">&nbsp;$i</div>\n";
  }
  $mdl_temp.="<td>".&select_create(
 	'name'		=>	"year1",
	'value'		=>	$yearR1,
	'maxlength'	=>	30,
	'width'		=>	$width1,
	'width1'	=>	50,
	'select'	=>	$mdl_micro
  )."</td>";


  $mdl_temp.="<td>&nbsp;</td>";


  my $mdl_micro;
  for (my $i=0;$i<=23;$i++)
  {
   $mdl_micro.="<div onclick=\"this.parentElement.parentElement.all['VALUE'].value='$i';\">&nbsp;$i</div>\n";
  }
  $mdl_temp.="<td>".&select_create(
 	'name'		=>	"hour1",
	'value'		=>	$hourR1,
	'maxlength'	=>	30,
	'width'		=>	$width0,
	'width1'	=>	50,
	'select'	=>	$mdl_micro
  )."</td>";

  $mdl_temp.="<td></td>";

  my $mdl_micro;
  for (my $i=0;$i<=55;$i=$i+5)
  {
   $mdl_micro.="<div onclick=\"this.parentElement.parentElement.all['VALUE'].value='$i';\">&nbsp;$i</div>\n";
  }
  $mdl_temp.="<td>".&select_create(
 	'name'		=>	"min1",
	'value'		=>	$minR1,
	'maxlength'	=>	30,
	'width'		=>	$width0,
	'width1'	=>	50,
	'select'	=>	$mdl_micro
  )."</td>";


  #$mdl_temp.="</table>";

  $mdl_temp.="</tr></table></td><td style=\"FONT:10px Verdana;COLOR:white;\">";
  $mdl_temp.="</td><td style=\"FONT:10px Verdana;COLOR:white;\" width=\"50%\" valign=\"bottom\">";

  #$mdl_temp.="<td nowrap>-</td>";

  $mdl_temp.="<table cellspacing=2 cellpadding=0 border=0><tr><td colspan=16 valign=\"top\"></td></tr><tr>";

  my $mdl_micro;
  for (my $i=1;$i<=31;$i++)
  {
   $mdl_micro.="<div onclick=\"this.parentElement.parentElement.all['VALUE'].value='$i';\">&nbsp;$i</div>\n";
  }
  $mdl_temp.="<td>".&select_create(
 	'name'		=>	"day2",
	'value'		=>	$mdayR2,
	'maxlength'	=>	30,
	'width'		=>	$width0,
	'width1'	=>	50,
	'select'	=>	$mdl_micro
  )."</td>";


  my $mdl_micro;
  @mesiac=("january","february","march","april","may","june","july","august","september","october","november","december");
  for (my $i=1;$i<=12;$i++)
  {
   $mdl_micro.="<div onclick=\"this.parentElement.parentElement.all['VALUE'].value='$i';\">&nbsp;$i-$mesiac[$i-1]</div>\n";
  }
  $mdl_temp.="<td>".&select_create(
 	'name'		=>	"mom2",
	'value'		=>	$momR2,
	'maxlength'	=>	30,
	'width'		=>	$width0,
	'width1'	=>	90,
	'select'	=>	$mdl_micro
  )."</td>";



  my $mdl_micro;
  for (my $i=2000;$i<=2050;$i++)
  {
   $mdl_micro.="<div onclick=\"this.parentElement.parentElement.all['VALUE'].value='$i';\">&nbsp;$i</div>\n";
  }
  $mdl_temp.="<td>".&select_create(
 	'name'		=>	"year2",
	'value'		=>	$yearR2,
	'maxlength'	=>	30,
	'width'		=>	$width1,
	'width1'	=>	50,
	'select'	=>	$mdl_micro
  )."</td>";


  $mdl_temp.="<td>&nbsp;</td>";


  my $mdl_micro;
  for (my $i=0;$i<=23;$i++)
  {
   $mdl_micro.="<div onclick=\"this.parentElement.parentElement.all['VALUE'].value='$i';\">&nbsp;$i</div>\n";
  }
  $mdl_temp.="<td>".&select_create(
 	'name'		=>	"hour2",
	'value'		=>	$hourR2,
	'maxlength'	=>	30,
	'width'		=>	$width0,
	'width1'	=>	50,
	'select'	=>	$mdl_micro
 )."</td>";

  $mdl_temp.="<td></td>";

  my $mdl_micro;
  for (my $i=0;$i<=55;$i=$i+5)
  {
   $mdl_micro.="<div onclick=\"this.parentElement.parentElement.all['VALUE'].value='$i';\">&nbsp;$i</div>\n";
  }
  $mdl_temp.="<td>".&select_create(
 	'name'		=>	"min2",
	'value'		=>	$minR2,
	'maxlength'	=>	30,
	'width'		=>	$width0,
	'width1'	=>	50,
	'select'	=>	$mdl_micro
  )."</td>";

  $mdl_temp.="</tr></table></td></table>";


  $mdl_temp.=<<"HEADER";
  &nbsp;Popis:<br>
 <input type=text name="description" id="description" value="$db_micro_line{description}" class=input0 maxlength=260 style="FONT:9px Verdana;width:445px;" drag_resizeX='0'><BR>
  <table height=16 width=100% cellspacing=0 cellpadding=0 border=0 background="$tom::H_media/grf/admin/win_top_0_back.gif"><tr><td width=50% align=right><img src="$tom::H_media/grf/admin/win_top_0_del.gif" border=0><BR></td><td><center><input type=submit drag_here value="Vyhľadať!" class=btn0></center></td><td align=left width=50%><img src="$tom::H_media/grf/admin/win_top_0_del.gif" border=0><BR></td></tr></table><br>
HEADER



=head1



  <TEXTAREA
	drag_resizeX='0'
	drag_resizeY='-300'
	name="indexes"
	id="indexes_all"
	class=input0
	style="width:445px;height:50px;FONT:12px Verdana;">$indexes</TEXTAREA><BR>
=cut



#<!-- <input type=hidden name=image value="$image_f"> /-->

  $mdl_temp.="</td><td></form></td></tr></table>";
  #$mdl_temp.="<script>lastOpenedArticleId=\"$db_micro_line{ID}\"; alert(lastOpenedArticleId);</script>";

my $box;

  if ($form{onlyarchive} eq "1") { $temp_string="Vyhľadávanie v archíve"; } else { $temp_string="Vyhľadávanie v nastaveniach grabberu"; }

  $box=&box_create2("$temp_string",
	'color_base0'	=>	"#0B63F1",
	'width'			=>	200,
	'height'		=>	50,
	'close'			=>	"yes",
	'html'			=>	$mdl_temp);


  return $box;

  return undef;
 }
}


1;
