#############################
#
# Apache superglobal configuration
#
#############################

# Reorder indexes
AddHandler cgi-script .pl
DirectoryIndex desktop.pl index.html core.tom core.pl index.php index.cgi

# EXTERNAL AUTHENTIFICATION
<IfModule mod_auth_external.c>
	# Cyclone3 USRM authentification
	AddExternalAuth tom3auth "/www/TOM/.bin/tom3-auth"
</IfModule>

<IfModule mod_authnz_external.c>
	# Cyclone3 USRM authentification
	AddExternalAuth tom3auth "/www/TOM/.bin/tom3-auth"
	SetExternalAuthMethod tom3auth environment
</IfModule>

# FASTCGI
<IfModule mod_fastcgi.c>
	# FastCgiIpcDir /var/fcgi
	# FCGI handlers
	AddHandler fastcgi-script .fcg .fcgi .tom
	#FastCgiConfig -appConnTimeout
	# 0-longlive 1-dynamic
	FastCgiConfig -gainValue 0.8
	#0.7
	#FastCgiConfig -gainValue 0.4
	# cim vyssie cislo tym brutalnejsie killovanie
	# cim nizsie cislo tym lahsie vytvaranie novych procesov
	FastCgiConfig -multiThreshold 80
	#FastCgiConfig -multiThreshold 20
	# chcem aby kazdy class mal aspon jeden nikdy nekillnuty process
	# ( process sa sam ukonci svojou reziou pri timeoute )
	FastCgiConfig -singleThreshold 10
	# za aku dobu moze byt nastartovana nova instancia existujuceho procesu
	#FastCgiConfig -init-start-delay 120
	FastCgiConfig -init-start-delay 120
	# kazdych X sekund sledujem zatazenie jednotlivych procesov
	FastCgiConfig -updateInterval 30
	# kazdych X sekund rozhodovanie o killovani procesov
	FastCgiConfig -killInterval 300
	# nizsie queue-depth zabezpeci skorsie startovanie novych procesov
	FastCgiConfig -listen-queue-depth 100
	#100
	FastCgiConfig -maxClassProcesses 2
	FastCgiConfig -maxProcesses 100
	FastCgiConfig -minProcesses 20
	# ak padnem, pokusim sa o restart
	#FastCgiConfig -restart 
	# restart az po X sekund
	FastCgiConfig -restart-delay 5
	#The process priority to be assigned to the application instances (using setpriority()).
	#FastCgiConfig -priority 0
	# po akom case ak proces neodpovie na request je povazovany za mrtvy
	# nasledkom je ze apache prerusi akukolvek dalsiu komunikaciu s tymto procesom
	# a spusta dalsie procesy
	FastCgiConfig -idle-timeout 360
</IfModule>


# FCGID
<IfModule mod_fcgid.c>
	AddHandler fcgid-script .fcg .fcgi .tom
	#SpawnScoreUpLimit 10
	#SpawnScore 1
	#TerminationScore 2
	#MaxProcessCount 100
	#DefaultMaxClassProcessCount 3
</IfModule>

