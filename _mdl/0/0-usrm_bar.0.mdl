#!/bin/perl
# USE UTF-8 !!!
package Tomahawk::module;
use open ':utf8', ':std';
use encoding 'utf8';
use utf8;
use strict;
=head1 HEAD_VERSION
1.030723

=head1 NAME
usrm_bar

=head1 DESCRIPTION
user management information bar

=head1 XMLDESCRIPTION

<DESCRIPTION>
 <value id="preview" value="1"/>
 <value id="output" value="xsgn"/>
 	<source type="db_300" value="db">user management table db (default - web db)</source>
	<input id="friend_count" value="int">number of friends online (data from smdl)</input>
	<input id="logged" value="boolean">user is online (data from smdl)</input>

</DESCRIPTION>

=head1 CHANGES
build 030628 - Deboot
	*) FIRST MAKE

=head1 WARNINGS & BUGS
	*) nothing
=cut

sub execute
{
 my %env=@_;
 Tomahawk::GetXSGN(-convertvars=>1) || return undef; # LOADING XML DESIGN
 #Tomahawk::GetXLNG() || return undef; # LOADING XML LANGUAGE
 #$XSGN{TMP}=%usrm_data;
 #return 1;
 if ($main::USRM{logged} eq "Y")
 {
   $XSGN{TMP} = $XSGN{TMP_2};
   $XSGN{TMP}=~s|<%LOGIN-NAME%>|$main::USRM{login}|g;
 }
 else
 {
   $XSGN{TMP} = $XSGN{TMP_1};
 }

 $env{a_online_count}="0" if $env{a_online_count} eq "";
 if ($env{a_chat_count} eq "") { $XSGN{TMP}=~s|<%CHAT_COUNT%>|0|g; } else { $XSGN{TMP}=~s|<%CHAT_COUNT%>|$env{a_chat_count}|g; }
 if ($env{a_chat_friend_count} eq "") { $XSGN{TMP}=~s|<%CHAT_FRIEND_COUNT%>|0|g; } else { $XSGN{TMP}=~s|<%CHAT_FRIEND_COUNT%>|$env{a_chat_friend_count}|g; }
 if ($env{a_friend_count} eq "") { $XSGN{TMP}=~s|<%FRIEND_COUNT%>|0|g; } else { $XSGN{TMP}=~s|<%FRIEND_COUNT%>|$env{a_friend_count}|g; }
 if ($env{a_online_count} eq "") { $XSGN{TMP}=~s|<%USER_COUNT%>|0|g; } else { $XSGN{TMP}=~s|<%USER_COUNT%>|$env{a_online_count}|g; }

return 1;
}

1;
