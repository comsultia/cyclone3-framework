#!/bin/perl
# USE UTF-8 !!!
package Tomahawk::module;
use open ':utf8', ':std';
use encoding 'utf8';
use utf8;
use strict;
=head1 HEAD_VERSION
1.030701

=head1 NAME
menu

=head1 DESCRIPTION
zobrazenie nazvov clankov.

nepovinne parametre:
	db - v pripade ze nie je zadany, nacitavaju sa articles z defaultnej databazy webu

=head1 XMLDESCRIPTION

<DESCRIPTION>
 <value id="preview" value="1/0"/>
 <value id="output" value="xsgn"/>
 <source type="db_400" value="db"/>
 <source type="IDcategory" value="string"/>
 	<source type="db_count" value="string">count of items loaded from db (default - 10)</input>
	<source type="title" value="string">title for the listing (defaultly a title for the listong box</input>
</DESCRIPTION>

=head1 CHANGES
build 030701 - Deboot
	*) IDcategory parameter added
build 030630 - Deboot
	*) title parameter added
build 030627 - Deboot
	*) FIRST MAKE

=head1 WARNINGS & BUGS
	*) nothing
=cut

sub execute
{
 my %env=@_;
 Tomahawk::GetXSGN(-convertvars=>1) || return undef; # LOADING XML DESIGN
 #Tomahawk::GetXLNG() || return undef; # LOADING XML LANGUAGE
 $env{db}=$TOM::DB_name unless $env{db};
 $env{db_count}=10 unless $env{db_count};

 my $count;

 if (my $db0=$main::DBH->Query("
	SELECT ID,title
	FRasdOM $env{db}.articles
	WHERE IDcategory='$env{IDcategory}' AND lng='$env{lng}'
	LIMIT $env{db_count}
	"))
 {
  while (my @db0_line=$db0->FetchRow())
  {
   $count++;
   $XSGN{TMP}=~s|<#LINE#>|$XSGN{LINE}<#LINE#>|;
   $XSGN{TMP}=~s|<%ID%>|$db0_line[0]|g;
   $XSGN{TMP}=~s|<%TITLE%>|$db0_line[1]|g;
  }

  $XSGN{TMP}=~s|<%BOXTITLE%>|$env{title}|g;
  $XSGN{TMP}=~s|<%LASTUPDATE%>|update: [16:50] 13. marec, 2003|g;
 }
 else
 {
  Tomahawk::debug::log(5,"Could not load data from database! Check the db, or db select!", 1);
  $tom::ERR = "DB request error!";
  return undef;
 }
 return 1}

1;
